
Контекст и диагноз (почему «Сетевая ошибка» не ушла)
- На странице /settings кнопка «Проверить соединение» в AISettingsCard вызывает `testAIConnection()` → `src/lib/aiService.ts` делает `fetch` на `/functions/v1/ai-test`.
- Сейчас backend‑функция `ai-test` фактически отсутствует в окружении: прямой вызов `/ai-test` возвращает 404 `Requested function was not found`.
- Из‑за этого браузерный `fetch` превращается в «Failed to fetch»/«Сетевая ошибка» (особенно когда 404 приходит без ожидаемых CORS-заголовков на шлюзе).

Цель
- Вернуть работу проверки соединения в настройках: чтобы «Тест соединения» не давал «Сетевая ошибка», а корректно показывал success/error.

Что будет сделано (минимальный фикс)
1) Подтвердить проблему
   - Проверить через серверный вызов, что `/ai-test` отвечает 404 (уже воспроизводится).
   - Убедиться, что `supabase/functions/ai-test/index.ts` существует в репозитории (он есть).

2) Задеплоить отсутствующую backend‑функцию `ai-test`
   - Выполнить деплой только `ai-test` (точечно), чтобы не трогать остальное.
   - Сразу после деплоя сделать тестовый POST на `/ai-test` с валидным `X-AI-Token` и убедиться, что возвращается JSON `{"success": true/false, ...}` (не 404).

3) Проверка в UI (end-to-end)
   - Открыть /settings → блок AI → нажать «Тест соединения».
   - Ожидаемое поведение:
     - больше нет «Сетевая ошибка»
     - появляется либо «Соединение установлено!», либо понятная ошибка от сервиса (rate limit/ключ/и т.п.)

Усиление надежности (необязательно, но рекомендую)
4) Сделать UI-обработку 404 более «человечной» (чтобы в будущем не выглядело как «сломался интернет»)
   - В `testAIConnection()` добавить спец-кейс: если ответ 404/NOT_FOUND (или JSON с code=NOT_FOUND), показывать сообщение вида:
     - RU: «Сервис проверки временно недоступен. Обновите приложение или попробуйте позже.»
     - EN: аналогично
   - Это не заменяет деплой, но делает UX устойчивым.

Какие файлы/объекты затронем
- Деплой: backend‑функция `ai-test` (существующий код `supabase/functions/ai-test/index.ts`).
- (Опционально) Frontend: `src/lib/aiService.ts` (улучшить сообщение при 404).

Порядок работ
- Сначала деплой `ai-test` → потом проверка `/ai-test` → потом проверка в /settings → затем (по желанию) улучшение обработки 404 в UI.

Критерий готовности
- В /settings кнопка «Тест соединения» отрабатывает без «Сетевая ошибка» и показывает корректный результат.
